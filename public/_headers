# Aurban — Netlify HTTP Headers
# Prevents search engine indexing of admin/provider pages.
# Adds strict security headers across all routes.

# ── Global security headers ────────────────────────────────
/*
  # Prevent MIME-type sniffing
  X-Content-Type-Options: nosniff

  # Deny framing (clickjacking protection)
  X-Frame-Options: DENY

  # Legacy XSS filter for older browsers
  X-XSS-Protection: 1; mode=block

  # Restrict referrer to same origin cross-site
  Referrer-Policy: strict-origin-when-cross-origin

  # Allow microphone for WebRTC voice calls; geolocation for GPS verification/address step
  # Camera stays blocked (audio-only calls); payment stays blocked (Paystack uses popup, not iframe API)
  Permissions-Policy: camera=(), microphone=(self), geolocation=(self), payment=()

  # Enforce HTTPS for 1 year, include subdomains
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

  # Prevent DNS prefetching leaking visited URLs
  X-DNS-Prefetch-Control: off

  # Content Security Policy
  # - script-src: Paystack inline.js loaded dynamically by payment.service.js
  # - frame-src: Paystack renders payment modal in an iframe
  # - connect-src: Supabase, Termii OTP, Google Maps, Mapbox, Paystack API
  Content-Security-Policy: default-src 'self'; script-src 'self' https://js.paystack.co; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; img-src 'self' data: https: blob:; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://v3.api.termii.com https://maps.googleapis.com https://api.mapbox.com https://api.paystack.co; frame-src 'self' https://checkout.paystack.com https://js.paystack.co; frame-ancestors 'none'; form-action 'self'; base-uri 'self'; object-src 'none'

# ── Admin login (non-obvious path) — block indexing ────────
/ax7-internal
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
  Cache-Control: no-store, no-cache, must-revalidate, private
  X-Frame-Options: DENY

# ── Provider/admin dashboard — block indexing ──────────────
/provider/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
  Cache-Control: no-store, no-cache, must-revalidate, private
  X-Frame-Options: DENY

# ── User dashboard — block indexing ────────────────────────
/dashboard/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
  Cache-Control: no-store, no-cache, must-revalidate, private

# ── Onboarding — block indexing ────────────────────────────
/onboarding
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
  Cache-Control: no-store, no-cache, must-revalidate, private

# ── Block common admin path guesses ────────────────────────
/admin/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
  Cache-Control: no-store, no-cache, must-revalidate, private

/console/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet

/ops/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet

/manage/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet

/internal/*
  X-Robots-Tag: noindex, nofollow, noarchive, nosnippet
